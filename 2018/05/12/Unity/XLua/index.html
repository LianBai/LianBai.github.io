<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>XLua | LianBai</title>
  <meta name="keywords" content=" Lua ">
  <meta name="description" content="XLua | LianBai">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="github">
<meta property="og:url" content="http://yoursite.com/github/index.html">
<meta property="og:site_name" content="LianBai">
<meta property="og:locale">
<meta property="article:published_time" content="2018-05-10T02:52:17.000Z">
<meta property="article:modified_time" content="2021-12-27T03:39:09.486Z">
<meta property="article:author" content="LianBai">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="LianBai" type="application/atom+xml">
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>
<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>LianBai</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"></use>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/lianbai" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:841774407@qq.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=841774407&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(29)</small></div></li>
    
        
            
            <li><div data-rel="Unity">Unity<small>(8)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Unity专栏">Unity专栏<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Unity杂文">Unity杂文<small>(10)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="其他">其他<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="编程语言">编程语言<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Unity框架">Unity框架<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="计算机基础">计算机基础<small>(2)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="29">
<input type="hidden" id="yelog_site_word_count" value="67.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://lianbai.github.io/">Lianbai</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="以 in: 开头进行全文搜索" autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">VR</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">IOC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">NUnit</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Shader</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">UGUI</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">AR</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Lua</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">UniRx</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Odin Inspector</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">插件</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Unity编辑器扩展</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">AssetBundle</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Unity4IOS</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">JSON</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">XMind</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">海外Google</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Prefab</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">博客搭建</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">网址</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">git</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">JAVA</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">BAT</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">LBFramework</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">操作系统</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">网络原理</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
		
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
		<a 
        
        <a  class="Unity "
           href="/2018/05/12/Unity/XLua/"
           data-tag="Lua"
           data-author="" >
            <span class="post-title" title="XLua">XLua</span>
            <span class="post-date" title="2018-05-12 09:33:32">2018/05/12</span>
        </a>
        
        <a  class="计算机基础 "
           href="/2018/05/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86%E6%95%99%E7%A8%8B/"
           data-tag="网络原理"
           data-author="" >
            <span class="post-title" title="计算机网络原理教程">计算机网络原理教程</span>
            <span class="post-date" title="2018-05-16 16:21:13">2018/05/16</span>
        </a>
        
        <a  class="Unity "
           href="/2018/06/01/Unity/Vuforia%E6%95%99%E7%A8%8B/"
           data-tag="AR"
           data-author="" >
            <span class="post-title" title="Vuforia教程">Vuforia教程</span>
            <span class="post-date" title="2018-06-01 10:40:37">2018/06/01</span>
        </a>
        
        <a  class="计算机基础 "
           href="/2018/06/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%95%99%E7%A8%8B/"
           data-tag="操作系统"
           data-author="" >
            <span class="post-title" title="计算机操作系统教程">计算机操作系统教程</span>
            <span class="post-date" title="2018-06-03 09:13:04">2018/06/03</span>
        </a>
        
        <a  class="Unity "
           href="/2018/08/19/Unity/HTC-VIVE/"
           data-tag="VR"
           data-author="" >
            <span class="post-title" title="HTC VIVE">HTC VIVE</span>
            <span class="post-date" title="2018-08-19 15:03:46">2018/08/19</span>
        </a>
        
        <a  class="编程语言 "
           href="/2018/08/19/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="JAVA"
           data-author="" >
            <span class="post-title" title="JAVA学习笔记">JAVA学习笔记</span>
            <span class="post-date" title="2018-08-19 17:42:39">2018/08/19</span>
        </a>
        
        <a  class="其他 "
           href="/2018/08/26/%E5%85%B6%E4%BB%96/XMind%E6%95%99%E7%A8%8B/"
           data-tag="XMind"
           data-author="" >
            <span class="post-title" title="XMind教程">XMind教程</span>
            <span class="post-date" title="2018-08-26 09:27:54">2018/08/26</span>
        </a>
        
        <a  class="Unity "
           href="/2019/09/20/Unity/Shader/"
           data-tag="Shader"
           data-author="" >
            <span class="post-title" title="Shader">Shader</span>
            <span class="post-date" title="2019-09-20 11:05:18">2019/09/20</span>
        </a>
        
        <a  class="其他 "
           href="/2019/09/21/%E5%85%B6%E4%BB%96/github-hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"
           data-tag="博客搭建"
           data-author="" >
            <span class="post-title" title="github+hexo博客搭建">github+hexo博客搭建</span>
            <span class="post-date" title="2019-09-21 10:44:45">2019/09/21</span>
        </a>
        
        <a  class="Unity "
           href="/2019/09/23/Unity/NUnit%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
           data-tag="NUnit"
           data-author="" >
            <span class="post-title" title="NUnit单元测试">NUnit单元测试</span>
            <span class="post-date" title="2019-09-23 09:00:31">2019/09/23</span>
        </a>
        
        <a  class="Unity "
           href="/2019/09/23/Unity/UGUI/"
           data-tag="UGUI"
           data-author="" >
            <span class="post-title" title="UGUI">UGUI</span>
            <span class="post-date" title="2019-09-23 09:00:31">2019/09/23</span>
        </a>
        
        <a  class="Unity "
           href="/2019/09/23/Unity/UniRx%E5%85%A5%E9%97%A8/"
           data-tag="UniRx"
           data-author="" >
            <span class="post-title" title="UniRx入门">UniRx入门</span>
            <span class="post-date" title="2019-09-23 09:00:31">2019/09/23</span>
        </a>
        
        <a  class="Unity "
           href="/2019/09/27/Unity/IOC%E5%85%A5%E9%97%A8/"
           data-tag="IOC"
           data-author="" >
            <span class="post-title" title="IOC入门">IOC入门</span>
            <span class="post-date" title="2019-09-27 09:10:01">2019/09/27</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2019/09/28/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94AssetBundle%E8%87%AA%E5%8A%A8%E6%A0%87%E8%AE%B0/"
           data-tag="AssetBundle"
           data-author="" >
            <span class="post-title" title="Unity杂文——AssetBundle自动标记">Unity杂文——AssetBundle自动标记</span>
            <span class="post-date" title="2019-09-28 16:35:10">2019/09/28</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2019/09/28/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94IOS%E5%90%8E%E5%8F%B0%E6%8E%A8%E9%80%81/"
           data-tag="Unity4IOS"
           data-author="" >
            <span class="post-title" title="Unity杂文——IOS后台推送">Unity杂文——IOS后台推送</span>
            <span class="post-date" title="2019-09-28 17:09:59">2019/09/28</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2019/09/28/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%942D%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6%E9%9B%86%E5%90%88/"
           data-tag="插件"
           data-author="" >
            <span class="post-title" title="Unity杂文——2D游戏开发常用插件集合">Unity杂文——2D游戏开发常用插件集合</span>
            <span class="post-date" title="2019-09-28 20:50:08">2019/09/28</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2019/09/30/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94JSON%E6%95%B0%E6%8D%AE%E8%BD%AC%E5%8C%96%E4%B8%BAExcel%E8%A1%A8%E6%A0%BC/"
           data-tag="JSON"
           data-author="" >
            <span class="post-title" title="Unity杂文——JSON数据转化为Excel表格">Unity杂文——JSON数据转化为Excel表格</span>
            <span class="post-date" title="2019-09-30 10:41:20">2019/09/30</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2019/09/30/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94AssetDatabase%E8%B5%84%E6%BA%90%E6%95%B0%E6%8D%AE%E5%BA%93/"
           data-tag="Unity编辑器扩展"
           data-author="" >
            <span class="post-title" title="Unity杂文——AssetDatabase资源数据库">Unity杂文——AssetDatabase资源数据库</span>
            <span class="post-date" title="2019-09-30 14:22:19">2019/09/30</span>
        </a>
        
        <a  class="其他 "
           href="/2019/10/14/%E5%85%B6%E4%BB%96/%E5%B8%B8%E7%94%A8%E7%BD%91%E7%AB%99%E7%BD%91%E5%9D%80/"
           data-tag="网址"
           data-author="" >
            <span class="post-title" title="常用网站网址">常用网站网址</span>
            <span class="post-date" title="2019-10-14 13:20:04">2019/10/14</span>
        </a>
        
        <a  class="Unity专栏 "
           href="/2019/10/29/Unity%E4%B8%93%E6%A0%8F/Odin-Inspector%E5%85%A5%E9%97%A8/"
           data-tag="Odin Inspector"
           data-author="" >
            <span class="post-title" title="Odin Inspector入门">Odin Inspector入门</span>
            <span class="post-date" title="2019-10-29 15:41:56">2019/10/29</span>
        </a>
        
        <a  class="编程语言 "
           href="/2019/11/24/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/bat%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="BAT"
           data-author="" >
            <span class="post-title" title="bat学习笔记">bat学习笔记</span>
            <span class="post-date" title="2019-11-24 10:05:06">2019/11/24</span>
        </a>
        
        <a  class="编程语言 "
           href="/2019/11/24/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
           data-tag="git"
           data-author="" >
            <span class="post-title" title="git学习笔记">git学习笔记</span>
            <span class="post-date" title="2019-11-24 11:09:11">2019/11/24</span>
        </a>
        
        <a  class="Unity框架 "
           href="/2020/07/30/Unity%E6%A1%86%E6%9E%B6/LBFramwork%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA/"
           data-tag="LBFramework"
           data-author="" >
            <span class="post-title" title="LBFramwork框架搭建">LBFramwork框架搭建</span>
            <span class="post-date" title="2020-07-30 14:40:08">2020/07/30</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2021/04/19/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94UGUI%E4%B8%AD%E7%B2%92%E5%AD%90%E7%9A%84%E9%81%AE%E7%BD%A9%E4%B8%8E%E8%A3%81%E5%89%AA/"
           data-tag="UGUI"
           data-author="" >
            <span class="post-title" title="Unity杂文——UGUI中粒子的遮罩与裁剪">Unity杂文——UGUI中粒子的遮罩与裁剪</span>
            <span class="post-date" title="2021-04-19 10:48:13">2021/04/19</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2021/04/20/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94UGUI%E5%9F%BA%E4%BA%8E%E5%9B%BE%E9%9B%86%E7%9A%84shader%E9%81%AE%E7%BD%A9/"
           data-tag="UGUI"
           data-author="" >
            <span class="post-title" title="Unity杂文——UGUI基于图集的shader遮罩">Unity杂文——UGUI基于图集的shader遮罩</span>
            <span class="post-date" title="2021-04-20 14:25:21">2021/04/20</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2021/04/30/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8EUGUI%E5%AE%9E%E7%8E%B0%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%9C%86%E5%BD%A2Image/"
           data-tag="UGUI"
           data-author="" >
            <span class="post-title" title="Unity杂文——基于UGUI实现性能更好的圆形Image">Unity杂文——基于UGUI实现性能更好的圆形Image</span>
            <span class="post-date" title="2021-04-30 11:00:36">2021/04/30</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2021/07/09/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94%E6%B5%B7%E5%A4%96%E5%BC%80%E5%8F%91%E8%B8%A9%E5%9D%91%E7%AC%94%E8%AE%B0/"
           data-tag="海外Google"
           data-author="" >
            <span class="post-title" title="Unity杂文——海外开发踩坑笔记">Unity杂文——海外开发踩坑笔记</span>
            <span class="post-date" title="2021-07-09 18:25:32">2021/07/09</span>
        </a>
        
        <a  class=""
           href="/2021/12/27/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2021-12-27 11:39:09">2021/12/27</span>
        </a>
        
        <a  class="Unity杂文 "
           href="/2021/12/30/Unity%E6%9D%82%E6%96%87/Unity%E6%9D%82%E6%96%87%E2%80%94%E2%80%94%E8%A7%A3%E5%86%B3Unity%E4%BF%AE%E6%94%B9Prefab%E7%9A%84%E5%8F%82%E6%95%B0%E4%B8%8D%E7%94%9F%E6%95%88%EF%BC%8C%E6%97%A0%E6%B3%95%E4%BF%9D%E5%AD%98/"
           data-tag="Prefab"
           data-author="" >
            <span class="post-title" title="Unity杂文——解决Unity修改Prefab的参数不生效，无法保存">Unity杂文——解决Unity修改Prefab的参数不生效，无法保存</span>
            <span class="post-date" title="2021-12-30 10:06:39">2021/12/30</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-Unity/XLua" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">XLua</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a href="javascript:" data-rel="Unity">Unity</a>
            
        </span>
        
        
        <span class="tag">
            
            <a href="javascript:" class="color4">Lua</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2021-12-27 11:39:09'>2018-05-12 09:33</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:6.5k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XLua%E6%95%99%E7%A8%8B"><span class="toc-text">XLua教程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#XLua%E5%8A%A0%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-text">XLua加载文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">加载字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BDlua%E6%96%87%E4%BB%B6"><span class="toc-text">加载lua文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Loader"><span class="toc-text">自定义Loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E8%AE%BF%E9%97%AELua"><span class="toc-text">C#访问Lua</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%85%A8%E5%B1%80%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="toc-text">访问全局基本类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E4%B8%80%E4%B8%AA%E5%85%A8%E5%B1%80%E7%9A%84table"><span class="toc-text">访问一个全局的table</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%9A%84class"><span class="toc-text">映射到一个普通的class</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AADictionary%E4%B8%AD"><span class="toc-text">映射到一个Dictionary中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AAList%E9%87%8C"><span class="toc-text">映射到一个List里</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AAinterface"><span class="toc-text">映射到一个interface</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AALuaTable%E5%8F%98%E9%87%8F"><span class="toc-text">映射到一个LuaTable变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E4%B8%80%E4%B8%AAfunaction"><span class="toc-text">访问一个funaction</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AA%E5%A7%94%E6%89%98%EF%BC%88Action%E6%88%96%E8%80%85delgate%EF%BC%89"><span class="toc-text">映射到一个委托（Action或者delgate）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lua%E8%84%9A%E6%9C%AC%E5%A4%9A%E8%BF%94%E5%9B%9E%E5%80%BC%E6%98%A0%E5%B0%84"><span class="toc-text">lua脚本多返回值映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84lua%E8%BF%94%E5%9B%9E%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">映射lua返回复杂类型的函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-text">使用建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lua%E8%AE%BF%E9%97%AEC-%E8%84%9A%E6%9C%AC"><span class="toc-text">Lua访问C#脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lua%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAC-%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="toc-text">lua创建一个C#的对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lua%E8%AE%BF%E9%97%AEC-%E7%9A%84%E9%9D%99%E6%80%81%E5%B1%9E%E6%80%A7%E3%80%81%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-text">lua访问C#的静态属性、静态方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lua%E8%AE%BF%E9%97%AEC-%E6%88%90%E5%91%98%E5%B1%9E%E6%80%A7%E3%80%81%E6%96%B9%E6%B3%95"><span class="toc-text">lua访问C#成员属性、方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lua%E8%AE%BF%E9%97%AE%E6%99%AE%E9%80%9A%E7%9A%84%E7%B1%BB"><span class="toc-text">lua访问普通的类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lua%E8%AE%BF%E9%97%AE%E7%BB%A7%E6%89%BF%E7%9A%84%E7%B1%BB"><span class="toc-text">lua访问继承的类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%A4%8D%E6%9D%82%E5%87%BD%E6%95%B0"><span class="toc-text">访问复杂函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E9%87%8D%E8%BD%BD%E6%96%B9%E6%B3%95"><span class="toc-text">访问重载方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-text">调用操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%90%AB%E9%BB%98%E8%AE%A4%E5%80%BC%E6%96%B9%E6%B3%95"><span class="toc-text">访问含默认值方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%96%B9%E6%B3%95"><span class="toc-text">访问可变参数方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E6%9E%9A%E4%B8%BE%E5%B9%B6%E8%AE%BF%E9%97%AE%E6%9E%9A%E4%B8%BE"><span class="toc-text">映射枚举并访问枚举</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lua%E8%AE%BF%E9%97%AEC-%E5%A7%94%E6%89%98"><span class="toc-text">Lua访问C#委托</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lua%E8%AE%BF%E9%97%AE%E7%B1%BB%E7%9A%84%E4%BA%8B%E4%BB%B6-Event"><span class="toc-text">Lua访问类的事件(Event)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lua%E8%AE%BF%E9%97%AE64%E4%BD%8D%E6%95%B4%E6%95%B0"><span class="toc-text">Lua访问64位整数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E5%92%8Ctable%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">C#复杂类型和table的转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lua%E8%8E%B7%E5%8F%96C-%E7%9A%84%E7%B1%BB%E5%9E%8B-%E7%9B%B8%E5%BD%93%E4%BA%8EC-%E7%9A%84typeof"><span class="toc-text">Lua获取C#的类型(相当于C#的typeof)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Lua%E5%BC%BA%E8%BD%AC%E6%95%B0%E6%8D%AE"><span class="toc-text">Lua强转数据</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XLua%E9%85%8D%E7%BD%AE"><span class="toc-text">XLua配置</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><blockquote>
<p>从**<a target="_blank" rel="noopener" href="https://github.com/Tencent/xLua"><font color=steelblue size=3>这里</font></a>**下载一个zip压缩包，解压后会有Assets等几个文件夹，其他文件夹放进你所创建的unity工程的Assets同级的目录下，然后把加压出来的Assets里的文件和文件夹复制进unity项目的Assets文件夹里即可。</p>
</blockquote>
<h1 id="XLua教程"><a href="#XLua教程" class="headerlink" title="XLua教程"></a>XLua教程</h1><h2 id="XLua加载文件"><a href="#XLua加载文件" class="headerlink" title="XLua加载文件"></a>XLua加载文件</h2><h3 id="加载字符串"><a href="#加载字符串" class="headerlink" title="加载字符串"></a>加载字符串</h3><pre><code>1.LuaEnv luaenv = new LuaEnv();  
2.luaenv.DoString(&quot;print(&#39;hello world&#39;)&quot;);  
</code></pre>
<blockquote>
<p>第1行是用来实例LuaEnv虚拟机的，类似于用这个类来实现所有lua的操作，尽量定义为全局，这样优化<br>第2行是通过DoString函数来加载lua脚本，也可直接加载lua脚本内容，如上述代码，print(‘hello world’)就是lua的代码内容。加载就是把lua的脚本加载到luaenv虚拟机里。</p>
</blockquote>
<h3 id="加载lua文件"><a href="#加载lua文件" class="headerlink" title="加载lua文件"></a>加载lua文件</h3><pre><code>LuaEnv luaenv = new LuaEnv();
//方法一
public TextAsset lua_001;
//方法二
private TextAsset lua_002;
//方法三
//在Start函数里luaenv.DoString(&quot;require &#39;LuaText/lua_003&#39;&quot;);
void Start()
&#123;
    lua_002 = Resources.Load&lt;TextAsset&gt;(&quot;LuaText/lua_002.lua&quot;);
    luaenv.DoString(lua_001.text);
    luaenv.DoString(lua_002.text);
    luaenv.DoString(&quot;require &#39;LuaText/lua_003&#39;&quot;);
&#125;

void Update()
&#123;

&#125;
void OnDestroy()
&#123;
    luaenv.Dispose();
&#125;
</code></pre>
<blockquote>
<p>lua脚本在放在Resources文件夹的时候，后缀必须加上.txt，例如<strong>lua_001.lua.txt</strong>，因为Resources对支持的文件类型有限，也就是无法用Resouces读取.lua文件。  </p>
<p>方法一是在脚本所挂物体上，通过拖拽赋值变量的方法，直接把lua的脚本拖拽到脚本的变量上，然后通过DoString执行lua文件<br>方法二是先定义TextAsset变量，然后在初始化的时候读取Resources里的文件，然后赋值到变量上，然后通过DoString执行lua文件。<br>方法三此处主要是对require和loader的理解，可以吧loader看成是指向某个路径里的一个个文件，require实际上就是调用一个个loader去加载，和自己所输入文件名字匹配，有一个成功，就不再往下进行查找，全部失败则报找不到文件的错误，目前xLua除了包含自己原本的loader外还包含了Resource所加载的loader，也就是require也可直接读取Resources目录下的文件，类似Resources的读取，但是因为Resource支持的文件类型有限，所以如果lua脚本放进了Resources文件里，就必须在后面加一个.txt的后缀，就像<strong>lua_001.lua.txt</strong>。<br>建议在整个程序中加载脚本只用一个DoString(“require’main’”),然后在main.lua脚本里可以加载自己所需要的其他脚本，其实就只把main.lua脚本看成一个接口脚本，然后在这个脚本里加载其他的lua脚本。  </p>
</blockquote>
<h3 id="自定义Loader"><a href="#自定义Loader" class="headerlink" title="自定义Loader"></a>自定义Loader</h3><pre><code>LuaEnv luaenv = null;
void Start () &#123;
    luaenv = new LuaEnv();
    LuaEnv.CustomLoader loader = CustomLoaderMethod;
    luaenv.AddLoader(loader);
    luaenv.DoString(&quot;require(&#39;main&#39;)&quot;);
&#125;



// Update is called once per frame
void Update () &#123;
    
&#125;
private byte[] CustomLoaderMethod(ref string filepath)
&#123;
    if(filepath== &quot;main&quot;)
    &#123;
        TextAsset lua_003 = Resources.Load&lt;TextAsset&gt;(&quot;LuaText/lua_003.lua&quot;);
        return System.Text.Encoding.UTF8.GetBytes(lua_003.text);
    &#125;
    return null;
&#125;
</code></pre>
<blockquote>
<p>有些脚本可能是程序运行下载下来的，或者是自定义的文件格式里头解压出来的，或者是需要解密的，所以存在文件不在指定的目录里，或者不是规定的lua脚本或者lua.txt格式，这样可有使用自定的loader，就类似于上面脚本，假如loader只包含原生的loader，这样就无法读取Resources里的文件夹，这样可以自定义loader,然后根据所要查找的lua脚本名字，指定到对应所在的地址，然后读取到需要的脚本，把文件里的内容一byte[]的形式回调回来即可，这样require(“脚本名字”)就可以直接执行脚本，不论脚本在什么位置，只要脚本所在的位置已经增加到loader上即可，即用LuaEnv.AddLoader（自己定义的loader），定义loader可以用LuaEnv.CustomLoader loader名字=CustomLoaderMethod来定义loader,用private byte[] CustomLoaderMethod(ref string filepath)函数来实现自己定义的loader.<br>通过AddLoader可以注册个回调，该回调参数是字符串，lua代码里头调用require时，参数将会透传给回调，回调中就可以根据这个参数去加载指定文件，如果需要支持调试，需要把filepath修改为真实路径传出。该回调返回值是一个byte数组，如果为空表示该loader找不到，否则则为lua文件的内容。 有了这个就简单了，用IIPS的IFS？没问题。写个loader调用IIPS的接口读文件内容即可。文件已经加密？没问题，自己写loader读取文件解密后返回即可。。。（<strong>此处的IIPS是什么可以不做了解</strong>）</p>
</blockquote>
<h2 id="C-访问Lua"><a href="#C-访问Lua" class="headerlink" title="C#访问Lua"></a>C#访问Lua</h2><h3 id="访问全局基本类型"><a href="#访问全局基本类型" class="headerlink" title="访问全局基本类型"></a>访问全局基本类型</h3><p>lua脚本  </p>
<pre><code>a = 10  
b = 100  
c = &quot;LianBai&quot;
</code></pre>
<p>c#脚本   </p>
<pre><code>LuaEnv luaenv = null;
private TextAsset luatext;
void Start () 
&#123;
    luaenv = new LuaEnv();
    luatext = Resources.Load&lt;TextAsset&gt;(&quot;LuaText/lua_004.lua&quot;);
    luaenv.DoString(luatext.text);
    int a = luaenv.Global.Get&lt;int&gt;(&quot;a&quot;);
    string b = luaenv.Global.Get&lt;string&gt;(&quot;b&quot;);
    string c = luaenv.Global.Get&lt;string&gt;(&quot;c&quot;);
    print(&quot;a = &quot;+a);
    print(&quot;b = &quot; + b);
    print(&quot;c = &quot; + c);
&#125;
</code></pre>
<blockquote>
<p>C#访问Lua脚本里的变量其实很简单，只需要先用DoString加载脚本，然后在通过luaenv.Global.Get&lt;变量类型&gt;(“变量名”);即可读取自己所需要的基础变量。</p>
</blockquote>
<h3 id="访问一个全局的table"><a href="#访问一个全局的table" class="headerlink" title="访问一个全局的table"></a>访问一个全局的table</h3><p>lua脚本  </p>
<pre><code>d =&#123;
    x1=2,
    x2=3,
    x3=&quot;LianBai&quot;,
    4,
    5,
    6,
    add = function(self,a,b)
        return a+b
    end
&#125;
</code></pre>
<h4 id="映射到一个普通的class"><a href="#映射到一个普通的class" class="headerlink" title="映射到一个普通的class"></a>映射到一个普通的class</h4><p>C#脚本</p>
<pre><code>public class Table1
&#123;
    public int x2;
    public int x1;
    public string x3;
&#125;
Table1 table1 = luaenv.Global.Get&lt;Table1&gt;(&quot;d&quot;);
</code></pre>
<blockquote>
<p>可以自己测试输出table1的结果，根据结果可以看出lua的table映射到C#的class的时候，并不是按照顺序一一对应进行映射的，而是根据名字映射，lua的table中的x1变量只会映射到C#的class中的x1变量中，如果lua的table里没有class中所包含的变量，则会在class中赋值为空，如果lua中table变量多余class，多余的也不会赋值过来，只会把class所包含的赋值过来。</p>
</blockquote>
<h4 id="映射到一个Dictionary中"><a href="#映射到一个Dictionary中" class="headerlink" title="映射到一个Dictionary中"></a>映射到一个Dictionary中</h4><p>C#脚本</p>
<pre><code>Dictionary&lt;string,double&gt; table2= luaenv.Global.Get&lt;Dictionary&lt;string,double&gt;&gt;(&quot;d&quot;);
print(&quot;table1.x1:&quot; + table2[&quot;x1&quot;]);
print(&quot;table1.x2:&quot; + table2[&quot;x2&quot;]);
</code></pre>
<blockquote>
<p>在映射到Dictionary的时候，只会映射符合Dictionary自己定义的规则的变量，把变量名存为keys，把变量值存为对应的数据，所以不会把x3等后面的数据存到Dictionary里。</p>
</blockquote>
<h4 id="映射到一个List里"><a href="#映射到一个List里" class="headerlink" title="映射到一个List里"></a>映射到一个List里</h4><p>C#脚本</p>
<pre><code>List&lt;double&gt; table3= luaenv.Global.Get&lt;List&lt;double&gt;&gt;(&quot;d&quot;);
print(&quot;List的Count&quot; + table3.Count);
foreach(double i in table3)
&#123;
    print(&quot;i:&quot; + i);
&#125;
</code></pre>
<blockquote>
<p>在映射到List中，也只会映射到符合List规则的变量，但是有一点要注意的是，table中带keys的不会映射进List，不管储存的变量是不是符合规则，都不会映射进去，所以在上述脚本打印的时候，table3存的值是lua脚本中table中的4,5,6,三个变量。</p>
</blockquote>
<h4 id="映射到一个interface"><a href="#映射到一个interface" class="headerlink" title="映射到一个interface"></a>映射到一个interface</h4><p>C#脚本</p>
<pre><code>[CSharpCallLua]
public interface ITable4
&#123;
    int x1 &#123; get; set; &#125;
    int x2 &#123; get; set; &#125;
    string x3 &#123; get; set; &#125;
    int add(int a, int b);
&#125;

ITable4 table4 = luaenv.Global.Get&lt;ITable4&gt;(&quot;d&quot;);
print(&quot;table4 x1 = &quot; + table4.x1);
print(&quot;table4 x2 = &quot; + table4.x2);
print(&quot;table4 x3 = &quot; + table4.x3);
print(&quot;table4 add = &quot; + table4.add(5, 6));
</code></pre>
<blockquote>
<p>什么是interface？**<a target="_blank" rel="noopener" href="http://www.runoob.com/csharp/csharp-interface.html"><font color=steelblue size=3>点击这里</font></a>**。理解清楚interface后，从代码里我们可以看出接口类多了一个[CSharpCallLua]，这是在为这个类打上了一个标签，因为与LUA交互的代理和类型需要添加 CSharpCallLua 标签，xlua的特性之一就是标记，这一次与lua交互的特性标记则是[CSharpCallLua]，只有这样写，才可支持热更新。然后接口类的继承和普通类类似，也是根据变量名字一一对应的关系。</p>
</blockquote>
<h4 id="映射到一个LuaTable变量"><a href="#映射到一个LuaTable变量" class="headerlink" title="映射到一个LuaTable变量"></a>映射到一个LuaTable变量</h4><p>C#脚本</p>
<pre><code>LuaTable table5= luaenv.Global.Get&lt;LuaTable&gt;(&quot;d&quot;);
print(&quot;table5长度:&quot; + table5.Length);
print(&quot;table5.x1:&quot; + table5.Get&lt;int&gt;(&quot;x1&quot;));
print(&quot;table5.x2:&quot; + table5.Get&lt;int&gt;(&quot;x2&quot;));
print(&quot;table5.x3:&quot; + table5.Get&lt;string&gt;(&quot;x3&quot;));
</code></pre>
<blockquote>
<p>这是一种by ref方式，所以不会生成代码，但是这种方式比较慢，并且没有变量检测。</p>
</blockquote>
<h3 id="访问一个funaction"><a href="#访问一个funaction" class="headerlink" title="访问一个funaction"></a>访问一个funaction</h3><p>Lua脚本</p>
<pre><code>function e()
&#123;
    print(&quot;lua脚本的函数&quot;)
&#125;
function f(a, b)
    print(&#39;a&#39;, a, &#39;b&#39;, b)
    return 1, 2, &#123;x1 = 1024,x2 = 2048&#125;
end
function ret_e()
    print(&quot;LuaScripts return e function&quot;)
    return e
end
</code></pre>
<h4 id="映射到一个委托（Action或者delgate）"><a href="#映射到一个委托（Action或者delgate）" class="headerlink" title="映射到一个委托（Action或者delgate）"></a>映射到一个委托（Action或者delgate）</h4><p>C#脚本</p>
<pre><code>public static class AddGenerateList
&#123;
     [CSharpCallLua]
       public static List&lt;Type&gt; CSharpCallLua = new List&lt;Type&gt;()
    &#123;
        typeof(Action),
        typeof(Action&lt;bool&gt;),
    &#125;;
&#125;

Action function1 = luaenv.Global.Get&lt;Action&gt;(&quot;e&quot;);
function1();
</code></pre>
<blockquote>
<p>在把函数映射到Action的时候，一定要把Action添加到生成列表，脚本中第一个静态的AddGenerateList类就是把Action增加到生成列表里。然后才可把函数映射到Action中。否则将会报错。</p>
</blockquote>
<h4 id="lua脚本多返回值映射"><a href="#lua脚本多返回值映射" class="headerlink" title="lua脚本多返回值映射"></a>lua脚本多返回值映射</h4><p>C#脚本</p>
<pre><code>[CSharpCallLua]
public delegate int Function2(int a, string b, out int c, out Table1 d);

Function2 function2 = luaenv.Global.Get&lt;Function2&gt;(&quot;f&quot;);
Table1 table1;
int fun2_02;
int fun2_01 = function2(66, &quot;LianBai&quot;, out fun2_02, out table1);
print(&quot;fun2_01:&quot; + fun2_01);
print(&quot;fun2_02:&quot; + fun2_02);
print(&quot;table1.x1:&quot; + table1.x1);
print(&quot;table1.x2:&quot; + table1.x2);
</code></pre>
<blockquote>
<p>lua脚本里的函数支持多个返回值，而且返回值的类型也不同，在C#访问lua函数的时候，可以通过上述方法接收lua函数的多个返回值，第一个返回值直接接收映射过来函数的返回值，正如上述脚本里的fun2_01就是第一个返回值，然后后面的返回值均可用out接收，不过映射前声明的时候要用上述的声明方法：<br>[CSharpCallLua]<br>public delegate 第一个返回值类型 Function(参数1,参数2，…, out 第二个返回值,out 第三个返回值，…)</p>
</blockquote>
<h4 id="映射lua返回复杂类型的函数"><a href="#映射lua返回复杂类型的函数" class="headerlink" title="映射lua返回复杂类型的函数"></a>映射lua返回复杂类型的函数</h4><p>C#脚本</p>
<pre><code>[CSharpCallLua]
public delegate Action Function3();

Function3 function3 = luaenv.Global.Get&lt;Function3&gt;(&quot;ret_e&quot;);
print(&quot;第一步：&quot;);
function3();
print(&quot;第二步：&quot;);
Action function3_01 = function3();
function3_01();
</code></pre>
<blockquote>
<p>在C#访问lua的函数返回类型是复杂类型的时候，可以用委托接收，例如上述脚本，访问的函数的返回值是一个函数，在访问的时候，同样用委托接收，不过是两层委托，例如Function3的定义，function3所访问的就是访问对应的函数，然后用一个委托接收function3的返回值，然后就可以访问所返回的函数。</p>
</blockquote>
<h3 id="使用建议"><a href="#使用建议" class="headerlink" title="使用建议"></a>使用建议</h3><blockquote>
<p>1.访问lua全局数据，特别是table以及function，代价比较大，建议尽量少做，比如在初始化时把要调用的lua function获取一次（映射到delegate）后，保存下来，后续直接调用该delegate即可。table也类似。 </p>
</blockquote>
<blockquote>
<p>2.如果lua测的实现的部分都以delegate和interface的方式提供，使用方可以完全和xLua解耦：由一个专门的模块负责xlua的初始化以及delegate、interface的映射，然后把这些delegate和interface设置到要用到它们的地方。</p>
</blockquote>
<h2 id="Lua访问C-脚本"><a href="#Lua访问C-脚本" class="headerlink" title="Lua访问C#脚本"></a>Lua访问C#脚本</h2><h3 id="lua创建一个C-的对象"><a href="#lua创建一个C-的对象" class="headerlink" title="lua创建一个C#的对象"></a>lua创建一个C#的对象</h3><p>Lua脚本</p>
<pre><code>local CShapObject = CS.UnityEngine.GameObject(&quot;LianBai&quot;)
</code></pre>
<blockquote>
<p>通过上述方法可以用lua脚本创建一个新的gameobject,后面跟的字符串就是物体的名字，所以创建新物体的lua脚本就是**local lua函数名 = CS.对象(class)命名空间.C#对象(class)名(参数)**。</p>
</blockquote>
<h3 id="lua访问C-的静态属性、静态方法"><a href="#lua访问C-的静态属性、静态方法" class="headerlink" title="lua访问C#的静态属性、静态方法"></a>lua访问C#的静态属性、静态方法</h3><p>C#脚本</p>
<pre><code>LuaEnv luaenv = null;
private TextAsset luatext;
namespace MySpace
&#123;
    [LuaCallCSharp]
    public static class CShapStaticClass
    &#123;
        public static int a = 10;
        public static string b = &quot;LianBai&quot;;
    &#125;
&#125;

luaenv = new LuaEnv();
luatext = Resources.Load&lt;TextAsset&gt;(&quot;LuaText/lua_005.lua&quot;); 
luaenv.DoString(luatext.text);
print(CShapStaticClass.a);
</code></pre>
<p>Lua脚本</p>
<pre><code>local CShapObject = CS.UnityEngine.GameObject(&quot;LianBai&quot;)
local a=CS.MySpace.CShapStaticClass.a
local b=CS.MySpace.CShapStaticClass.b
CS.MySpace.CShapStaticClass.a=66
print(a);
print(b);
</code></pre>
<blockquote>
<p>lua在访问c#的静态变量时与创建对象类似，CS.命名空间.静态类.静态变量<br>如果需要经常访问的类，可以先用局部变量引用后访问，除了减少敲代码的时间，还能提高性能。</p>
</blockquote>
<h3 id="lua访问C-成员属性、方法"><a href="#lua访问C-成员属性、方法" class="headerlink" title="lua访问C#成员属性、方法"></a>lua访问C#成员属性、方法</h3><h4 id="lua访问普通的类"><a href="#lua访问普通的类" class="headerlink" title="lua访问普通的类"></a>lua访问普通的类</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass02
&#123;
    public int c = 99;
    public void Class02Fun01()
    &#123;
        Debug.Log(&quot;This is CShapClass01&#39;s function d&quot;);
    &#125;
&#125;
</code></pre>
<p>lua脚本</p>
<pre><code>local LuaClass02 = CS.MySpace.CShapClass02
local luaclass02 = LuaClass02()
print(luaclass02.c)
luaclass02.c = 88
luaclass02:Class02Fun01()
</code></pre>
<blockquote>
<p>lua在访问C#的成员属性和方法的时候，先用变量映射出C#的类，然后再用一个变量接收。local 变量1 = CS.类所在命名空间.类名,变量1是映射过来的对象的声明，需要自己定义一个对象，local 变量2 = 变量1()，即变量2就是所映射过来的类的实例，通过<strong>变量2.变量名</strong>就可访问变量，通过**变量2: 函数名()**就可启用C#的函数。</p>
</blockquote>
<h4 id="lua访问继承的类"><a href="#lua访问继承的类" class="headerlink" title="lua访问继承的类"></a>lua访问继承的类</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass01
&#123;
    public static int a = 1;
    public static string b = &quot;LianBai&quot;;
    public static void Class01Fun01()
    &#123;
        Debug.Log(&quot;This is Class01Fun01&quot;);
    &#125;
    public void Class01Fun02()
    &#123;
        Debug.Log(&quot;This is Class01Fun02&quot;);
    &#125;
&#125;
[LuaCallCSharp]
public class CShapClass02: CShapClass01
&#123;
    public int c = 99;
    public void Class02Fun01()
    &#123;
        Debug.Log(&quot;This is CShapClass01&#39;s function d&quot;);
    &#125;
&#125;
</code></pre>
<p>lua脚本  </p>
<pre><code>local LuaClass02 = CS.MySpace.CShapClass02
local luaclass02 = LuaClass02()
print(luaclass02.c)
print(LuaClass02.a)
print(LuaClass02.b)
luaclass02.c = 88
luaclass02:Class02Fun01()
LuaClass02.Class01Fun01()
luaclass02:Class01Fun02()
</code></pre>
<blockquote>
<p>lua在访问C#的含有继承类的类的时候，访问基类普通变量和访问子类一样，用<strong>变量2.变量名</strong>，和<strong>变量2：函数名</strong>来访问，但是在访问基类的静态变量的时候，通过<strong>变量1.变量名</strong>来访问基类<strong>静态变量</strong>，通过<strong>变量1：函数名</strong>来访问基类<strong>静态函数</strong>。xlua支持（通过派生类）访问基类的静态属性，静态方法，（通过派生类实例）访问基类的成员属性，成员方法。</p>
</blockquote>
<h4 id="访问复杂函数"><a href="#访问复杂函数" class="headerlink" title="访问复杂函数"></a>访问复杂函数</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass02
&#123;
    public int c = 99;
    public void Class02Fun01()
    &#123;
        Debug.Log(&quot;This is CShapClass01&#39;s function d&quot;);
    &#125;
    public double Class02Fun02(CShapClass01 cshapclass01,ref int x1,out string x2,Action luafun,out Action csfun)
    &#123;
        Debug.Log(cshapclass01.c + &quot; : &quot; + cshapclass01.d);
        luafun();
        x1 = x1 * cshapclass01.c;
        x2 = &quot;CShapClass01.d = &quot; + cshapclass01.d;
        csfun = () =&gt;
        &#123;
            Debug.Log(&quot;This is CsFun&quot;);
        &#125;;
        Debug.Log(x1 + &quot; : &quot; + x2);
        return 6.66;
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass02 = CS.MySpace.CShapClass02
local luaclass02 = LuaClass02()
function LuaFun()
    print(&quot;This is LuaFun&quot;)
end
local cshapclass01,x1,x2,csfun = luaclass02:Class02Fun02(&#123;c = 100,d = &quot;LianHei&quot;&#125;,88,LuaFun)
print(&quot;cshapclass01:&quot;,cshapclass01)
print(&quot;x1:&quot;, x1)
print(&quot;x2:&quot;, x2)
print(&quot;csfun:&quot;, csfun)
csfun();
</code></pre>
<blockquote>
<p>参数的输入输出属性（out，ref）<br>Lua调用测的参数处理规则：C#的普通参数算一个输入形参，ref修饰的算一个输入形参，out不算，然后从左往右对应lua 调用测的实参列表；<br>Lua调用测的返回值处理规则：C#函数的返回值（如果有的话）算一个返回值，out算一个返回值，ref算一个返回值，然后从左往右对应lua的多返回值。  </p>
<p>上述话的意思是lua在映射复杂的函数的时候，C#函数中的参数中有普通参数，ref定义的参数，out定义的参数，例如上述的<em>Class02Fun02</em>函数中<em>CShapClass01 cshapclass01</em>是普通的参数，就是我们正常定义的参数，<em>ref int x1</em>和<em>out string x2</em>分别是ref和out定义的参数，在lua调用的时候，<em>luaclass02:Class02Fun02({c = 100,d = “LianHei”},88,LuaFun)<em>，第一个表</em>{c = 100,d = “LianHei”}<em>是给</em>cshapclass01</em>传参数，88传给的是x1,LuaFun是传给的,Action luafun,因为x2和csfun是out形容的参数，所以不用传递。  </p>
<p>ref定义的参数，在调用的时候要传参数，在返回的时候也要接收，out定义的参数在调用的时候不用传递参数，但是在接收的时候要接收参数<br>在调用这个函数的时候会执行C#脚本里面的函数，然后函数会有返回值，如果函数本身就有返回值，则lua脚本在接收的第一个返回值就是函数的返回值，然后在C#函数中有些参数是ref或者out参数，这些参数从左往右依次都是函数的返回值，所以在C#函数里必须为这些参数赋值。</p>
</blockquote>
<h4 id="访问重载方法"><a href="#访问重载方法" class="headerlink" title="访问重载方法"></a>访问重载方法</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass03
&#123;
    public void CShapFun()
    &#123;
        Debug.Log(&quot;This is NULL&quot;);
    &#125;
    public void CShapFun(int a)
    &#123;
        Debug.Log(&quot;This is int&quot;);
    &#125;
    public void CShapFun(string a)
    &#123;
        Debug.Log(&quot;This is string&quot;);
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass03 = CS.MySpace.CShapClass03
local luaclass03 = LuaClass03()
luaclass03:CShapFun()
luaclass03:CShapFun(2)
luaclass03:CShapFun(&quot;LianBai&quot;)
</code></pre>
<blockquote>
<p>在C#里运行脚本可以看出，在访问重载函数的时候，只要改变穿进去的参数，就会自动调用重载对应的函数。<br>注意：xlua只一定程度上支持重载函数的调用，因为lua的类型远远不如C#丰富，存在一对多的情况，比如C#的int，float，double都对应于lua的number，上面的例子中TestFunc如果有这些重载参数，第一行将无法区分开来，只能调用到其中一个（生成代码中排前面的那个）</p>
</blockquote>
<h4 id="调用操作符"><a href="#调用操作符" class="headerlink" title="调用操作符"></a>调用操作符</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass03
&#123;
    public int a = 66;
    public string b = &quot;LianBai&quot;;
    public static CShapClass03 operator + (CShapClass03 class1, CShapClass03 class2)
    &#123;
        CShapClass03 ret = new CShapClass03();
        ret.a = class1.a + class2.a;
        ret.b = class1.b + class2.b;
        return ret;
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass03 = CS.MySpace.CShapClass03
local luaclass03 = LuaClass03()
local luaclass04 = LuaClass03()
print(luaclass03.a)
print(luaclass04.b)
luaclass04.a = 88
print(luaclass04.a)
print(&quot;This &quot;,(luaclass03 + luaclass04).a)
luaclass03.b=&quot;I am &quot;
print((luaclass03+luaclass04).b)
</code></pre>
<blockquote>
<p>在lua使用所访问的对象的操作符的时候，在对象内部必须重载此运算符，这样才可以使用此运算符，C#的运算符可以自己百度查询。然后在类里面即可像C#里面一样调用，允许操作的运算符有：<br>+，-，*，/，==，一元-，&lt;，&lt;=， %，[]</p>
</blockquote>
<h4 id="访问含默认值方法"><a href="#访问含默认值方法" class="headerlink" title="访问含默认值方法"></a>访问含默认值方法</h4><p>C#脚本</p>
<pre><code>public void CShapClass03DefaultFun(int a = 66,string b = &quot;LianBai&quot;,string c = null)
&#123;
    Debug.Log(&quot;a = &quot; + a + &quot; b = &quot; + b + &quot; c = &quot; + c);
&#125;
</code></pre>
<p>Lua脚本  </p>
<pre><code>local LuaClass03 = CS.MySpace.CShapClass03
local luaclass03 = LuaClass03()
luaclass03:CShapClass03DefaultFun()
luaclass03:CShapClass03DefaultFun(88)
luaclass03:CShapClass03DefaultFun(88,&quot;LianHei&quot;)
luaclass03:CShapClass03DefaultFun(88,&quot;LianHei&quot;,&quot;COOL&quot;)
</code></pre>
<blockquote>
<p>在访问含有默认值的方法时，在lua里调用函数和C#调用有默认值参数的函数一样，如果所给的实参少于形参，则会用默认值补上。  </p>
</blockquote>
<h4 id="访问可变参数方法"><a href="#访问可变参数方法" class="headerlink" title="访问可变参数方法"></a>访问可变参数方法</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass03
&#123;
    public int a = 66;
    public string b = &quot;LianBai&quot;;
    public void CShapClassVariableFun(int a,params string[] str)
    &#123;
        string s = null;
        foreach(string c in str)
        &#123;
            s = s + c +&quot; &quot;;
        &#125;
        Debug.Log(&quot;a = &quot; + a + &quot;  str = &quot; + s);
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass03 = CS.MySpace.CShapClass03
local luaclass03 = LuaClass03()
luaclass03:CShapClassVariableFun(10,&quot;I&quot;)
luaclass03:CShapClassVariableFun(20,&quot;I&quot;,&quot;am&quot;)
luaclass03:CShapClassVariableFun(30,&quot;I&quot;,&quot;am&quot;,&quot;LianBai&quot;)
</code></pre>
<blockquote>
<p>lua在访问的方法中含有可变参数（<a target="_blank" rel="noopener" href="http://www.runoob.com/csharp/csharp-param-arrays.html"><font color=steelblue >params</font></a>）的时候，也可以类似于在C#脚本的使用方法传进去参数。</p>
</blockquote>
<h4 id="映射枚举并访问枚举"><a href="#映射枚举并访问枚举" class="headerlink" title="映射枚举并访问枚举"></a>映射枚举并访问枚举</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public enum MyEnum
&#123;
    x1 = 66,
    x2 = 88,
    x3 = 99
&#125;
[LuaCallCSharp]
public class CShapClass04
&#123;
    public MyEnum CShapEnumFun(MyEnum e)
    &#123;
        Debug.Log(&quot;MyEnum:&quot; + e);
        return e;
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaEnum = CS.MySpace.MyEnum
print(LuaEnum.__CastFrom(&quot;x1&quot;),LuaEnum.__CastFrom(&quot;x2&quot;),LuaEnum.__CastFrom(&quot;x3&quot;))
local LuaClass04 = CS.MySpace.CShapClass04
local luaclass04 = LuaClass04()
local luaenum = luaclass04:CShapEnumFun(CS.MySpace.MyEnum.x1)
print(luaenum,luaenum == LuaEnum.x1)
print(LuaEnum.__CastFrom(0),LuaEnum.__CastFrom(1),LuaEnum.__CastFrom(2))
</code></pre>
<blockquote>
<p>在映射枚举的时候，直接像类一样直接声明枚举对象就可调用，方法是：<strong>local 变量1 = CS.枚举所在命名空间.枚举名</strong>，然后就可以通过<strong>变量1.key值</strong>就可访问枚举中的对象。<br>在映射类里面含有枚举参数的时候，可以直接通过**CS.枚举所在命名空间.枚举名.key值”<strong>直接传进key对应的值，也可直接通过映射过来的变量1，通过</strong>变量1.key值”<strong>访问对应的key值。<br>如果枚举类加入到生成代码的话，枚举类将支持</strong>__CastFrom()**方法，可以实现从一个整数或者字符串到枚举值的转换。（<font color=red >注：CastFrom前面是两个英文的下划线</font>)  </p>
</blockquote>
<h4 id="Lua访问C-委托"><a href="#Lua访问C-委托" class="headerlink" title="Lua访问C#委托"></a>Lua访问C#委托</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class CShapClass04
&#123;
    public MyEnum CShapEnumFun(MyEnum e)
    &#123;
        Debug.Log(&quot;MyEnum:&quot; + e);
        return e;
    &#125;
    public static Action&lt;string&gt; CShapStaticAction;
    public Action&lt;string&gt; CShapAction = (param) =&gt;
    &#123;
        Debug.Log(&quot;This is My CShapAction：&quot; + param);
    &#125;;
public delegate void CShapDelegate(string obj);
&#125;
[LuaCallCSharp]
public class CShapClass05
&#123;
    public CShapClass04.CShapDelegate MyClassFun = null;
    public CShapClass05()
    &#123;
        MyClassFun = new CShapClass04.CShapDelegate(MyAction) ;
    &#125;
    private void MyAction(string obj)
    &#123;
        Debug.Log(&quot;This is My CShapDelegates：&quot; + obj);
    &#125;
&#125;

MySpace.CShapClass04.CShapStaticAction += MyStaticAction;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass04 = CS.MySpace.CShapClass04
local luaclass04 = LuaClass04()
local LuaClass05 = CS.MySpace.CShapClass05
local luaclass05 = LuaClass05()
LuaClass04.CShapStaticAction(&quot;LianBai&quot;)
luaclass04.CShapAction(&quot;LianBai&quot;)
local MyLuaClass = luaclass05.MyClassFun
上MyLuaClass(&quot;LianBai&quot;)
MyLuaClass(&quot;LianBai&quot;)
local function LuaAction(str)
    print(&quot;This is LuaAction :&quot;,str)
end
local luaaction = LuaAction + LuaClass04.CShapStaticAction
luaaction(&quot;+&quot;)
local luaaction = LuaClass04.CShapStaticAction - LuaAction
luaaction(&quot;-&quot;)
local luaaction = LuaClass04.CShapStaticAction + LuaAction
luaaction(&quot;+2&quot;)
local luaaction = LuaClass04.CShapStaticAction - LuaAction
luaaction(&quot;-2&quot;)
</code></pre>
<blockquote>
<p>C#的委托关键字是delegate,Action和Func都是别人封装好的委托，通过上述方法可以观测到，delegate在定义委托的时候，默认就是静态的方法，但是Action定义委托的时候需要手动添加关键字，如果没有添加关键字，只能通过对象调用，但是无法传递参数，因为delegate本身是静态的，所以导致无法使用，关于delegate和Action、Func的区别请**<a target="_blank" rel="noopener" href="https://blog.csdn.net/cubesky/article/details/39577879"><font color=steelblue size=3>点击这里</font></a>**  、<br>通过上述脚本，测试可发现，lua在访问委托的时候，和调用普通的函数方法一样。<br>+操作符：对应C#的+操作符，把两个调用串成一个调用链，右操作数可以是同类型的C# delegate或者是lua函数。<br>-操作符：和+相反，把一个delegate从调用链中移除。<br>+操作符左右任意一个是delegate就可以，但是-操作符delegate必须放在左边<br>Ps：delegate属性可以用 一个luafunction来赋值。</p>
</blockquote>
<h4 id="Lua访问类的事件-Event"><a href="#Lua访问类的事件-Event" class="headerlink" title="Lua访问类的事件(Event)"></a>Lua访问类的事件(Event)</h4><p>C#脚本  </p>
<pre><code>[LuaCallCSharp]
public class DelegateClass
&#123;
    public delegate void MyDelegate();  //定义一个委托
    public event MyDelegate myevent;    //定义了一个事件
    public void ClassFun01()
    &#123;
        myevent();
    &#125;
&#125;
</code></pre>
<p>Lua脚本  </p>
<pre><code>local LuaClass = CS.MySpace01.DelegateClass
local luaclass = LuaClass()
local function luafun01()
    print(&quot;This is luafun01&quot;)
end
local function luafun02()
    print(&quot;This is luafun02&quot;)
end
luaclass:myevent(&quot;+&quot;,luafun01)
luaclass:ClassFun01()
luaclass:myevent(&quot;+&quot;,luafun02)
luaclass:ClassFun01()
luaclass:myevent(&quot;-&quot;,luafun01)
luaclass:ClassFun01()
</code></pre>
<blockquote>
<p>Lua在访问<a target="_blank" rel="noopener" href="http://www.runoob.com/csharp/csharp-event.html"><font color=steelblue >Event</font></a>的时候，添加事件回调的方法是**类对象:委托名(“+”,函数名)<strong>，同样的，在移除事件回调的时候是</strong>类对象:委托名(“-“,函数名)**。</p>
</blockquote>
<h4 id="Lua访问64位整数"><a href="#Lua访问64位整数" class="headerlink" title="Lua访问64位整数"></a>Lua访问64位整数</h4><p>C#脚本</p>
<pre><code>public ulong LongFun(long l)
&#123;
    return (ulong)l + 1;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass = CS.MySpace01.DelegateClass
local luaclass = LuaClass()
local a = luaclass:LongFun(11)
print(type(a),a+10,a+100,a+1000,a+10000)
</code></pre>
<blockquote>
<p>Lua53版本64位整数（long，ulong）映射到原生的64未整数，而luaji版本t，相当于lua5.1的标准，本身不支持64位，xlua做了个64位支持的扩展库，C#的long和ulong都将映射到userdata：<br>支持在lua里头进行64位的运算，比较，打印<br>支持和lua number的运算，比较<br>要注意的是，在64扩展库中，实际上只有int64，ulong也会先强转成long再传递到lua，而对ulong的一些运算，比较，我们采取和java一样的支持方式，提供一组API，详情请看API文档。</p>
</blockquote>
<h4 id="C-复杂类型和table的转换"><a href="#C-复杂类型和table的转换" class="headerlink" title="C#复杂类型和table的转换"></a>C#复杂类型和table的转换</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public class MyClass01
&#123;
    public int a;
    public void Show()
    &#123;
        Debug.Log(&quot;This is MyClass01&#39;s a:&quot; + a);
    &#125;
&#125;
[LuaCallCSharp]
public class MyClass02
&#123;
    public MyClass01 a;
    public string b;
    public void Show()
    &#123;
        a.Show();
        Debug.Log(&quot;This is MyClass02&#39;s b:&quot; + a);
    &#125;

&#125;
[LuaCallCSharp]
public class MyClass03
&#123;
    public void Set(MyClass02 my)
    &#123;
        my.Show();
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass = CS.MySpace01.MyClass03
local luaclass = LuaClass()
luaclass:Set(&#123;a=&#123;a=66&#125;,b=&quot;LianBai&quot;&#125;)
</code></pre>
<blockquote>
<p>Lua在访问复杂的Class参数时，一个{}就是一个类，如果想用上述方法，变量必须public，这样lua才能根据变量名进行赋值，就像一开头讲的，根据变量名字进行赋值。</p>
</blockquote>
<h4 id="Lua获取C-的类型-相当于C-的typeof"><a href="#Lua获取C-的类型-相当于C-的typeof" class="headerlink" title="Lua获取C#的类型(相当于C#的typeof)"></a>Lua获取C#的类型(相当于C#的typeof)</h4><p>Lua脚本<br>    print(typeof(CS.MySpace01))</p>
<blockquote>
<p>要获取CS.MySpace01类的Type信息，可以用上述脚本</p>
</blockquote>
<h4 id="Lua强转数据"><a href="#Lua强转数据" class="headerlink" title="Lua强转数据"></a>Lua强转数据</h4><p>C#脚本</p>
<pre><code>[LuaCallCSharp]
public interface MyClass04
&#123;
    void  Show(int a, string b);
&#125;
[LuaCallCSharp]
public class MyClass05 : MyClass04
&#123;
    public int ID = 88;
    public void Show(int a, string b)
    &#123;
        Debug.Log(a);
        Debug.Log(b);
    &#125;
    public MyClass04 GetClass04()
    &#123;
        return new MyClass05();
    &#125;
&#125;
</code></pre>
<p>Lua脚本</p>
<pre><code>local LuaClass01 = CS.MySpace01.MyClass05 
local luaclass01 = LuaClass01()
local luainterface01 = luaclass01:GetClass04()
luainterface01:Show(66,&quot;LianBai&quot;)
assert(luainterface01.ID == 88)
--assert(luainterface01.ID == nil)

local LuaClass02 = CS.MySpace01.MyClass05 
local luaclass02 = LuaClass02()
local luainterface02 = luaclass02:GetClass04()
cast(luainterface02,typeof(CS.MySpace01.MyClass04))
luainterface02:Show(88,&quot;LianHei&quot;)
--assert(luainterface02.ID == 88)
assert(luainterface02.ID == nil)
</code></pre>
<blockquote>
<p>什么是<a target="_blank" rel="noopener" href="http://www.runoob.com/lua/lua-error-handling.html"><font color=steelblue >assert</font></a>？<br>通过上代码演示和输出，我们不难看出第一种访问和第二种访问的区别，如果我们把lua里面注释掉的两个代码解放开，就会抛出异常，我们在访问interface或者抽象的时候，我们的实现类都是隐藏的，所以，在访问的时候是进行映射到C#脚本里，其实还是在C#脚本里运行，这就是映射过去，所以我们第一种访问，依旧可以访问到ID，因为C#里有ID这个变量，其实luainterface只是C#的类的映射，本质还是C#的类，然后我们在第二种方法中，只是添加了一个**cast(luainterface02,typeof(CS.MySpace01.MyClass04))**这样我们就告诉lua，把这个接口加到生成代码里，所以我们就是把接口类放进了lua文件里，只是我们看不见而已，这样我们的接口就不存在ID这个变量了。但是方法依然存在。<br>lua没类型，所以不会有强类型语言的“强转”，但有个有点像的东西：告诉xlua要用指定的生成代码去调用一个对象，这在什么情况下能用到呢？有的时候第三方库对外暴露的是一个interface或者抽象类，实现类是隐藏的，这样我们无法对实现类进行代码生成。该实现类将会被xlua识别为未生成代码而用反射来访问，如果这个调用是很频繁的话还是很影响性能的，这时我们就可以把这个interface或者抽象类加到生成代码，然后指定用生成代码来访问。</p>
</blockquote>
<h1 id="XLua配置"><a href="#XLua配置" class="headerlink" title="XLua配置"></a>XLua配置</h1>
      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 841774407@qq.com </span>
    </div>
	<div class="post-nav">
		
		
			<div class="post-nav-next post-nav-item">
			<a href="/2018/05/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86%E6%95%99%E7%A8%8B/" >计算机网络原理教程<i class="fa fa-chevron-right"></i></a>
			</div>
		
	</div>
</article>


<p>
    <a href="javascript:void(0)" class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>XLua</p>
    <p><span class="copy-title">文章字数:</span><span class="post-count">6.5k</span></p>
    <p><span class="copy-title">本文作者:</span><a href="javascript:void(0)" title="LianBai">LianBai</a></p>
    <p><span class="copy-title">发布时间:</span>2018-05-12, 09:33:32</p>
    <p><span class="copy-title">最后更新:</span>2021-12-27, 11:39:09</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2018/05/12/Unity/XLua/" title="XLua">http://yoursite.com/2018/05/12/Unity/XLua/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    








    </div>
    <div class="copyright">
        <p class="footer-entry">©2016-2019 lianbai</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" href="javascript:void(0)"></a>
    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['@脸白','#VR','#IOC','#NUnit','#Shader','#UGUI','#AR','#Lua','#UniRx','#Odin Inspector','#插件','#Unity编辑器扩展','#AssetBundle','#Unity4IOS','#JSON','#XMind','#海外Google','#Prefab','#博客搭建','#网址','#git','#JAVA','#BAT','#LBFramework','#操作系统','#网络原理',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #fbf4a8;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    .post {
        background: url(http://file.liangxiegame.com/229fb8f1-d85a-417c-ac21-7b33f12f191f.png);
		background-size: cover;
		background: rgba(27,31,35,.05);
    }
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("http://file.liangxiegame.com/62f4f67f-3353-4bae-a348-860f5aaf71e3.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

</html>
